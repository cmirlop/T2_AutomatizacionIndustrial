\section{Grafcets}
\label{sec:introduccion}

\subsection{Grafcet Principal}
En la siguiente figura (\hyperref[graf:principal]{Grafcet Principal}), vemos el grafcet principal, el cual se encarga 
de poner la máquina en marcha, una vez no hay emergencia,funciona de manera que si modificamos 
el selector a modo manual, se va a activar el modo manual hasta que lo desactivemos, que entonces ahi,
si apretamos marcha, empezará la máquina con el  (\hyperref[graf:mantenimiento]{Grafcet de mantenimiento}), y poteriormente activará 
ya las primeras máquinas de cada objeto.

\begin{figure}[H]
	\centering
	\scalebox{0.75}{\input{./grafcets/0_Principal.tex}}
	\medskip
	\label{graf:principal}
	\caption{Grafcet Principal}
\end{figure}

Este grafcet está descompuesto en las siguientes ecuaciones algebráicas:\\

\newlength{\sepsGrups}
\setlength{\sepsGrups}{2ex}

% Transiciones (sin FORCE_CURRENT_E)
$S_{0} = \mathtt{FirstScan} + X_{3}\cdot \mathtt{Paro\_Ciclo} + X_{4}\cdot \Not{\mathtt{Modo\_Manual}}$\\
$S_{1} = X_{0}\cdot (\mathtt{Marcha}+\mathtt{HMI\_Marcha})\cdot \Not{\mathtt{Modo\_Manual}}$\\
$S_{2} = X_{1}\cdot \mathtt{Mantenimiento\_Fin} + X_{3}\cdot \Not{\mathtt{Paro\_Ciclo}}$\\
$S_{3} = X_{2}\cdot \mathtt{Pieza\_Empaquetada}$\\
$S_{4} = X_{0}\cdot \mathtt{Modo\_Manual}$\\[\sepsGrups]

% Etapas (sin FORCE_INIT_E)
$X_{0} = S_{0} + X_{0}\cdot \Not{(S_{1}+S_{4})}$\\
$X_{1} = S_{1} + X_{1}\cdot \Not{S_{2}}$\\
$X_{2} = S_{2} + X_{2}\cdot \Not{S_{3}}$\\
$X_{3} = S_{3} + X_{3}\cdot \Not{(S_{0}+S_{2})}$\\
$X_{4} = S_{4} + X_{4}\cdot \Not{S_{0}}$\\[\sepsGrups]

% Marcas
$\mathtt{Act\_Mantenimiento} = X_{1}$\\
$\mathtt{Proceso\_Activo} = X_{2} + X_{3}$\\
$\mathtt{Modo\_Manual\_Activado} = X_{4}$\\[\sepsGrups]

% Contadores (mismo tipo/formato del ejemplo)
IF X0 THEN\\
\hspace*{2em}C = 0\\
END IF\\
IF X3 THEN\\
\hspace*{2em}C = C + 1\\
END IF\\[\sepsGrups]


\subsection{Grafcet Paro}
En la siguietne figura(\hyperref[graf:paro]{Grafcet Paro}) observamos el grafcet que trata el botón del paro, 
cuando apretamos este botón activamos una marca que recibe el grafcet principal para que se deje 
de emitir piezas y se queden las que están ya en la máquina.

\begin{figure}[H]
	\centering
	\scalebox{0.75}{\input{./grafcets/0P_Paro.tex}}
	\medskip
	\label{graf:paro}
	\caption{Grafcet del botón de Paro}
\end{figure}

Este grafcet está descompuesto en las siguientes ecuaciones algebráicas:\\


% Transiciones (sin FORCE_CURRENT_E)
$S_{0p} = \mathtt{FirstScan} + X_{0}$\\
$S_{1p} = X_{0}\cdot (\mathtt{STOP\_NEG} + \mathtt{HMI\_Paro})$\\[\sepsGrups]

% Etapas (sin FORCE_INIT_E)
$X_{0p} = S_{0p} + X_{0p}\cdot \Not{S_{1p}}$\\
$X_{1p} = S_{1p} + X_{1p}\cdot \Not{S_{0p}}$\\[\sepsGrups]

% Marcas
$\mathtt{Paro\_Ciclo} = X_{1p}$\\